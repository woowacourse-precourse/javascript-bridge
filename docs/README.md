## 학습목표

- [x] `객체는 객체답게 구성하고 코드를 짠다`는 것이 무엇인지 학습하고 이번 미션에 최대한 녹아내려고 노력한다.

  - [x] 하나의 객체는 `단일책임원칙`을 지키도록 한다.
  - [x] 객체 내 변수는 `private 변수`를 사용, private 변수를 그대로 가져오는 `getter`를 지양한다.

- [x] `MVC 패턴`을 학습하고 이번 미션에 적용해보면서 `MVC 패턴에 장단점`에 대해 학습하고 MVC 패턴과 친해지기 위해 노력한다.

  - [x] `MVC 패턴`에서 `단위테스트`와 `TDD`를 어떻게 효율적으로 작성할지 고민하고 이를 프로젝트에 적용해본다.

## 회고

- 이번 4주차 미션을 진행하면서 어떤 걸 공부하고 가장 어려웠던 점과 이를 해결하기 위해 어떠한 방식으로 풀었는지에 대해 작성한 [제 블로그 글](https://velog.io/@turtle601/%ED%9A%8C%EA%B3%A0-%EC%9A%B0%EC%95%84%ED%95%9C-%ED%85%8C%ED%81%AC%EC%BD%94%EC%8A%A4-5%EA%B8%B0-4%EC%A3%BC%EC%B0%A8-%ED%9A%8C%EA%B3%A0-with-MVC-%EC%8B%B1%EA%B8%80%ED%86%A4)입니다.

## 객체를 객체답게 짠다는 것은?

객체도 우리 인간 사회와 마찬가지로 각자의 `역할`에 충실하면서 다른 객체와 소통하기 위해 `메세지`를 보내고 `협력`하는 행위를 통해 큰 사회(프로그램)을 이룬다고 학습하였습니다.

그래서 이번 미션에서는 이전 미션에서 학습한 객체의 유지보수성을 위해 의존성을 주입하고 분리하는 행위보단 **객체 간 `각자의 역할에 집중`, 각 객체가 다른 객체에게 `어떻게 메세지를 보내야하는가`에 대해 고민하면서 코드를 구현하였습니다.**

## MVC 적용 이유?

문제 내에서 **UI와, 단위 로직을 구분한다**는 내용과 `BridgeGame 클래스`의 함수가 `MVC 패턴의 Controller` 기능과 유사하다고 판단하여 MVC패턴을 공부해보았습니다.

MVC패턴에 대해 공부하면서 `Model`, `Controller`, `View` 각자의 역할에 충실하면서 데이터를 저장하고 읽어오면서 `메세지`를 보내고 `협력`하는 행위가 이번 학습목표와 부합하다고 판단하여 적용하게 되었습니다.

## MVC 적용 방법

MVC계층에서 많은 로직들이 Controller에 부담된다고 판단, 이를 더 세분화하려고 공부하다보니 MVC패턴 5계층에 대해 알게 되었고
`View` - `Controller` - `Service` - `Repository` - `Model(new Map())`으로 구성하였습니다.

도메인 로직의 경우 각각에 맞는 클래스를 구현 `Service 클래스`에서 실행하도록 구현하였습니다.

## 기능 구현 목록

- [x] (Input Event) 다리 길이 입력 받기

  - [x] 입력받은 다리 길이가 3이상 20이하인지 확인 (error)
  - [x] 랜덤 다리 생성 (create)
  - [x] 사용자가 건널 다리 생성 (create)
  - [x] 시도 횟수 1 저장 (create)

- [x] 이동할 칸 입력 시 누른 값에 따라 다른 결과 도출 (move)

  - [x] `U`를 누르면 위에 칸 다리 건너기

    - [x] 사용자 다리 `O` 표시 (Update)

  - [x] `D`을 누르면 아래 칸 다리 건너기

    - [x] 사용자 다리 `X` 표시 (Update)

  - [x] 그 외 숫자를 누르면 에러 (error)

- [x] 유저 브릿지와 랜덤 브릿지 비교

  - [x] 결과값 도출 `[['O','X'],['','']]` (read)
  - [x] 유저 브릿지 성공, 계속 시도, 실패 여부 판단 (read)

* [x] 게임 재임 종료 후 누른 값에 따라 다른 결과 도출 (재시도: R, 종료: Q)

  - [x] R을 누르면 재시작

    - [x] 시도 횟수 + 1 (update)
    - [x] useBridge 데이터 `Reset` (update)

  - [x] Q를 누르면 종료

    - [x] 최종 결과 출력 (print)

  - [x] 그 외 숫자를 누르면 에러 (error)

  - [x] 최종 시도 Map 출력 (print)
  - [x] 게임 성공 여부 출력 (print)
  - [x] 게임 시도 횟수 출력 (print)

## 객체 설계도

<img width = "800px" src = "https://user-images.githubusercontent.com/78203399/203130306-8be81ec7-62dd-4eab-87a9-a91ab4a8b1a2.png" />

## MVC를 적용하면서 느낀 점

1. 객체 간 의존성이 매우 강하다.
   이번 미션에서는 MVC패턴을 `View - Controller - Service - Repository - Model` 5계층으로 만들어보면서 5개의 객체가 의존성이 매우 강해 초반 구현 및 설계가 굉장히 어려웠습니다. 특히 의존성이 강하다 보니 TDD 적용 시 작은 테스트부터 테스트를 하는데 어려움을 많이 느꼈습니다. (input 작업할 때 특히...)

   하지만 이런 의존성이 좋은가? 안 좋은가에 대해서도 많은 고민을 했습니다. 특히 MVC 패턴 같은 경우 `View - Controll - Model`의 관계를 `의존성 주입(DI)`을 하게 되면
   Model이 외부에 드러나면서 `보안`에 대해서는 안 좋은 영향을 미칠 수 있다고 판단했습니다.

   이번 미션에서는 Service 내부 도메인 관련 클래스에 생성자 주입을 통한 DI를 구현하여 테스트가 용이하게 코드를 구현하였습니다.

2. 관심사의 분리
   이번 미션에서는 MVC패턴을 적용하면서 각 **객체의 역할을 명확히 분리**하고 각 객체에서 모델의 데이터를 읽고 쓰는 과정을 하기 위해 객체 간 `메세지`를 보내는 과정을 직접 구현해보면서 객체 지향적인 코드를 짤 수 있었다는 장점이 있었다.

## 리팩토링

### 1차

**Controller 객체 싱글톤 구현**

- `InputView`에 데이터를 검증하고 저장하는 로직을 추가
- `printView`와 `InputView`와 동일한 데이터(객체)를 다뤄야 한다고 판단, Controller객체를 싱글톤으로 구현

### 2차

- 브릿지 게임 결과 데이터를 구하는 `BridgeCheck` 클래스에 userBridgeMap 정보와 전체 게임 결과 내용을 도출하는 내용이 있어
  객체의 단일책임 원칙에 위반된다고 생각해 `BridgeUserMap`, `BridgeFinalResult` 클래스로 분리하였습니다.

---

## 그 외

아래 내용은 제가 이번 미션을 수행하면서 객체 구현 및 기능 구현 목록을 어떻게 작성하고 수정하였는지 보여주는 내용입니다.

## 순서도

1차 목표: 순서도를 통해서 테스트할 값들을 찾고 기능 목록을 구현하고 객체를 설계하자.

<img width = "600px" src = "https://user-images.githubusercontent.com/78203399/202339097-38a13f21-48ab-4b9e-bf28-38e627af2dd4.jpeg" />

## 1차 기능 목록 구현

- 다리 길이 입력 받기

  - 입력받은 다리 길이가 3이상 20이하인지 확인 (에러 체크)

- 랜덤 다리 생성

- 이동할 칸 입력 시 누른 값에 따라 다른 결과 도출

  - U를 누르면 위에 칸 다리 건너기
  - R을 누르면 아래 칸 다리 건너기
  - 그 외 숫자를 누르면 에러

- 이동한 칸이 건널 수 있는 다리인 지 확인

  - 건널 수 있다면 o 출력
  - 건널 수 없다면 x 출력

- 다리를 모두 건넜는지 확인

- 게임 재시작 시 누른 값에 따라 다른 결과 도출

  - R을 누르면 재시작
  - Q를 누르면 종료
  - 그 외 숫자를 누르면 에러

- 재시도 요청 시 시도횟수 늘리기

> 1차 목표: 객체 설계에 대한 감이 전혀 오지 않아 도메인 로직을 분석해보고 도메인 로직에 따라 클래스를 만들고
> `테스트 코드 작성 - 기능 구현 - 테스트 - 커밋` 순으로 진행하려고 한다.

## 도메인 로직 나눠보기

## 기능 구현 목록 (1차 수정)

1. 다리(Bridge) 길이

- 다리 길이 입력 받기

  - 입력받은 다리 길이가 3이상 20이하인지 확인 (에러 체크)

- 2. 랜덤 다리 생성

- 랜덤 다리 생성

- 3. 이동할 칸 생성

- 이동할 칸 입력 시 누른 값에 따라 다른 결과 도출

  - U를 누르면 위에 칸 다리 건너기
  - D을 누르면 아래 칸 다리 건너기
  - 그 외 숫자를 누르면 에러

- 4. 재시작 도메인

- 게임 재시작 시 누른 값에 따라 다른 결과 도출

  - R을 누르면 재시작
  - Q를 누르면 종료
  - 그 외 숫자를 누르면 에러

- 5. 최종결과 도메인

  - 최종 시도 Map 출력
  - 게임 성공 여부 출력
  - 게임 시도 횟수 출력

- 6. 이동 결과 도메인

  -이동 결과 Map 출력

> 2. 도메인 별로 기능을 구현해보다가 대략적인 객체 구조에 필요성을 느껴서 객체 구조를 짰습니다.
>    이 과정을 통해서 `MVC패턴`을 학습하고 적용하려고 애썼습니다.

## 1차 객체 설계

<img width = "500px" src = "https://user-images.githubusercontent.com/78203399/202485813-5044a795-897b-471e-b7d7-20b39a621e16.jpeg">

## (2차 수정) 기능 목록 구현

> 객체 설계에 따라 기능 목록 구현을 나눠보았습니다.

1. 다리(Bridge) 길이 - BridgeLength 클래스

- (Input Event) 다리 길이 입력 받기 (start)

- 입력받은 다리 길이가 3이상 20이하인지 확인 (에러 체크) - 랜덤 다리 생성 (create) - 사용자가 건널 다리 생성 (create) - 시도 횟수 1 저장 (create)

- 2. (Keypress Event) 이동할 칸 생성 - UpDownKey 클래스

- 이동할 칸 입력 시 누른 값에 따라 다른 결과 도출 (move)

- `U`를 누르면 위에 칸 다리 건너기

  - 사용자 다리 `O` 표시 (Update)

- `D`을 누르면 아래 칸 다리 건너기

  - 사용자 다리 `X` 표시 (Update)

- 그 외 숫자를 누르면 에러

- 4. (Keypress Event) 재시작 도메인 - BridgeRestart 클래스

- 게임 재시작 시 누른 값에 따라 다른 결과 도출 (restart)

  - R을 누르면 재시작
  - Q를 누르면 종료
  - 그 외 숫자를 누르면 에러

- 5. 최종결과 도메인 - View 아직 미정

  - 최종 시도 Map 출력
  - 게임 성공 여부 출력
  - 게임 시도 횟수 출력

> `MVC패턴`에 대해 공부하던 중 MVC패턴에 계층이 존재한다는 사실을 알게 되었고
> 이에 따라 `Repository`라는 층을 하나 더 만들어 5계층을 구현하였다.

## 2차 객체 설계도

<img width = "800px" src = "https://user-images.githubusercontent.com/78203399/203130306-8be81ec7-62dd-4eab-87a9-a91ab4a8b1a2.png" />

## (3차 수정) 기능 구현 목록

> `랜덤 브릿지`와 `유저 브릿지`를 비교하는 로직이 없어서 추가

1. 다리(Bridge) 길이 - BridgeLength 클래스

- [x] (Input Event) 다리 길이 입력 받기 (start)

  - [x] 입력받은 다리 길이가 3이상 20이하인지 확인 (에러 체크)
  - [x] 랜덤 다리 생성 (create)
  - [x] 사용자가 건널 다리 생성 (create)
  - [x] 시도 횟수 1 저장 (create)

- 2. (Keypress Event) 이동할 칸 생성 - UpDownKey 클래스

- [x] 이동할 칸 입력 시 누른 값에 따라 다른 결과 도출 (move)

  - [x] `U`를 누르면 위에 칸 다리 건너기

    - [x] 사용자 다리 `O` 표시 (Update)

  - [x] `D`을 누르면 아래 칸 다리 건너기

    - [x] 사용자 다리 `X` 표시 (Update)

  - [x] 그 외 숫자를 누르면 에러

- 3. `랜덤 브릿지`와 `유저 브릿지`를 비교하는 도메인 - BridgeCheck 클래스

- [x] 유저 브릿지와 랜덤 브릿지 비교 -> 결과값 도출 [['O','X'],['','']]
- [x] 유저 브릿지 성공, 계속 시도, 실패 여부 판단

- 4. (Keypress Event) 재시작 도메인

- [x] 게임 재임 종료 후 누른 값에 따라 다른 결과 도출 (재시도: R, 종료: Q)

  - [x] R을 누르면 재시작

    - [x] 시도 횟수 + 1
    - [x] useBridge 데이터 `Reset`

  - [x] Q를 누르면 종료

    - [x] 최종 결과 출력

  - [x] 그 외 숫자를 누르면 에러

- 5. 최종결과 도메인 - View 아직 미정

  - [x] 최종 시도 Map 출력
  - [x] 게임 성공 여부 출력
  - [x] 게임 시도 횟수 출력

## 리팩토링

### 1차

- `InputView`에 데이터를 검증하고 저장하는 로직을 추가
- `printView`와 `InputView`와 동일한 데이터(객체)를 다뤄야 한다고 판단, Controller객체를 싱글톤으로 구현

### 2차

- 브릿지 게임 결과 데이터를 구하는 `BridgeCheck` 클래스에 userBridgeMap 정보와 전체 게임 결과 내용을 도출하는 내용이 있어
  객체의 단일책임 원칙에 위반된다고 생각해 `BridgeUserMap`, `BridgeFinalResult` 클래스로 분리하였습니다.
